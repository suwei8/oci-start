# OCI-Start é¡¹ç›®å®‰å…¨åˆ†ææŠ¥å‘Š

**åˆ†ææ—¥æœŸ**: 2025-12-09  
**åˆ†æç‰ˆæœ¬**: 1.0.0-SNAPSHOT  
**åˆ†æå¸ˆ**: è‡ªåŠ¨åŒ–ä»£ç å®¡è®¡

---

## ğŸ“‹ æ¦‚è¿°

OCI-Start æ˜¯ä¸€ä¸ªä½¿ç”¨ Oracle Cloud Infrastructure (OCI) Java SDK é›†æˆåˆ›å»ºå’Œç®¡ç†ç”²éª¨æ–‡äº‘å®ä¾‹çš„å¼€æºé¡¹ç›®ã€‚æœ¬æŠ¥å‘Šå¯¹è¯¥é¡¹ç›®è¿›è¡Œäº†å…¨é¢çš„æºä»£ç å®‰å…¨å®¡è®¡ã€‚

---

## âœ… æºä»£ç å¼€æºçŠ¶æ€

### ç»“è®ºï¼š**100% æºä»£ç å¼€æº**

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| Java æºæ–‡ä»¶ | âœ… é€šè¿‡ | å…± 22 ä¸ª Java æ–‡ä»¶ï¼Œå…¨éƒ¨ä¸ºäººç±»å¯è¯»æºä»£ç  |
| äºŒè¿›åˆ¶æ–‡ä»¶æ£€æŸ¥ | âœ… é€šè¿‡ | æœªå‘ç°ä»»ä½• `.jar`ã€`.class`ã€`.so`ã€`.dll`ã€`.exe` æ–‡ä»¶ |
| æ··æ·†ä»£ç æ£€æŸ¥ | âœ… é€šè¿‡ | æœªå‘ç°ä»»ä½•ä»£ç æ··æ·†æˆ–å‹ç¼© |
| ç¬¬ä¸‰æ–¹ä¾èµ– | âœ… é€šè¿‡ | å…¨éƒ¨æ¥è‡ª Maven Central å®˜æ–¹ä»“åº“ |
| å¼€æºè®¸å¯è¯ | âœ… é€šè¿‡ | Apache License 2.0 |

---

## ğŸ” é¡¹ç›®æ¶æ„åˆ†æ

### æ¨¡å—ç»“æ„

```
oci-start/
â”œâ”€â”€ oci-common/          # å…¬å…±æ¨¡å—ï¼ˆåŸºç¡€é…ç½®å’Œå·¥å…·ç±»ï¼‰
â”‚   â””â”€â”€ src/main/java/   # æ—  Java æºæ–‡ä»¶
â”œâ”€â”€ oci-server/          # ä¸»æœåŠ¡æ¨¡å—
â”‚   â””â”€â”€ src/main/java/   # 22 ä¸ª Java æ–‡ä»¶
â””â”€â”€ pom.xml              # Maven çˆ¶ POM
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| åº”ç”¨å…¥å£ | `OciServerApplication.java` | Spring Boot åº”ç”¨å¯åŠ¨ç±» |
| äº‘æœåŠ¡ç®¡ç† | `OracleCloudService.java` | OCI å®ä¾‹åˆ›å»ºã€VCNã€å­ç½‘ç­‰ç®¡ç†ï¼ˆ1042 è¡Œï¼‰ |
| å®ä¾‹ç®¡ç†å™¨ | `OracleInstanceManager.java` | å¤šç”¨æˆ·å®ä¾‹åˆ›å»ºä»»åŠ¡è°ƒåº¦ |
| æ¶ˆæ¯æœåŠ¡ | `TelegramMessageService.java` | Telegram é€šçŸ¥æ¨é€ |
| è®¤è¯é…ç½® | `MultiUserAuthenticationDetailsProvider.java` | å¤šç”¨æˆ· OCI è®¤è¯ç®¡ç† |

---

## ğŸ›¡ï¸ å®‰å…¨å®¡è®¡ç»“æœ

### åé—¨æ£€æŸ¥ï¼š**æœªå‘ç°åé—¨**

| æ£€æŸ¥ç±»å‹ | ç»“æœ | è¯¦æƒ… |
|----------|------|------|
| éšè—ç½‘ç»œè¿æ¥ | âœ… å®‰å…¨ | ä»…æœ‰ä¸€ä¸ªå¤–éƒ¨ URL è¿æ¥ï¼šTelegram API |
| ç¡¬ç¼–ç å‡­è¯ | âœ… å®‰å…¨ | æœªå‘ç°ç¡¬ç¼–ç çš„å¯†é’¥æˆ–å¯†ç  |
| æ•°æ®å¤–æ³„ | âœ… å®‰å…¨ | æ— å¯ç–‘æ•°æ®æ”¶é›†æˆ–ä¼ è¾“ä»£ç  |
| éšè—åŠŸèƒ½ | âœ… å®‰å…¨ | ä»£ç é€»è¾‘é€æ˜ï¼Œæ— éšè—åŠŸèƒ½ |
| æ¶æ„è„šæœ¬ | âœ… å®‰å…¨ | Cloud-init è„šæœ¬ä»…é…ç½® SSH è®¿é—® |

### å¤–éƒ¨ç½‘ç»œè¿æ¥åˆ†æ

é¡¹ç›®ä¸­å”¯ä¸€çš„å¤–éƒ¨ç½‘ç»œè¿æ¥ï¼š

```java
// TelegramMessageService.java
private static final String TG_URL = "https://api.telegram.org/bot%s/sendMessage?chat_id=%s&text=%s";
```

**ç”¨é€”**: å‘é€å®ä¾‹åˆ›å»ºæˆåŠŸé€šçŸ¥åˆ°ç”¨æˆ·é…ç½®çš„ Telegram é¢‘é“ã€‚  
**é£é™©ç­‰çº§**: ä½ï¼ˆç”¨æˆ·è‡ªè¡Œé…ç½® token å’Œ chatIdï¼‰

---

## ğŸ“¦ ä¾èµ–åˆ†æ

### Maven ä¾èµ–æ¥æº

**å…¨éƒ¨ä¾èµ–æ¥è‡ªå®˜æ–¹ Maven Central ä»“åº“**

| åˆ†ç±» | ä¾èµ–é¡¹ | ç‰ˆæœ¬ | æ¥æº |
|------|--------|------|------|
| æ¡†æ¶ | Spring Boot | 2.7.6 | Maven Central |
| OCI SDK | oci-java-sdk-core | 3.49.0 | Oracle å®˜æ–¹ |
| OCI SDK | oci-java-sdk-identity | 3.49.0 | Oracle å®˜æ–¹ |
| JSON | Jackson | 2.13.3 | Maven Central |
| å·¥å…· | Lombok | 1.18.24 | Maven Central |
| æ—¥å¿— | Log4j | 1.2.17 | Maven Central |

### ä¾èµ–å®‰å…¨è¯´æ˜

> âš ï¸ **æ³¨æ„**: Log4j 1.2.17 ç‰ˆæœ¬å·²ç» EOLï¼ˆEnd of Lifeï¼‰ï¼Œå»ºè®®å‡çº§åˆ° Log4j 2.x æˆ–ä½¿ç”¨ SLF4J + Logbackã€‚ä½†è¿™ä¸å±äºåé—¨é—®é¢˜ã€‚

---

## ğŸ” æ•æ„Ÿä¿¡æ¯å¤„ç†

### å‡­è¯å­˜å‚¨æ–¹å¼

| ç±»å‹ | å­˜å‚¨ä½ç½® | å®‰å…¨æ€§ |
|------|----------|--------|
| OCI ç§é’¥ | æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼ˆç”¨æˆ·æŒ‡å®šè·¯å¾„ï¼‰ | âœ… å®‰å…¨ |
| ç”¨æˆ· ID/Fingerprint | é…ç½®æ–‡ä»¶ï¼ˆpropertiesï¼‰ | âœ… å®‰å…¨ |
| Telegram Token | é…ç½®æ–‡ä»¶ï¼ˆpropertiesï¼‰ | âœ… å®‰å…¨ |
| Root å¯†ç  | é…ç½®æ–‡ä»¶ï¼ˆpropertiesï¼‰ | âš ï¸ æ˜æ–‡å­˜å‚¨ |

### é…ç½®æ–‡ä»¶æ¨¡æ¿ (`oci-start.properties`)

```properties
oracle.users.user1.userId=
oracle.users.user1.userName=
oracle.users.user1.fingerprint=
oracle.users.user1.tenancy=
oracle.users.user1.region=
oracle.users.user1.keyFile=           # æœ¬åœ°ç§é’¥æ–‡ä»¶è·¯å¾„
oracle.users.user1.rootPassword=      # å®ä¾‹ root å¯†ç ï¼ˆå»ºè®®åŠ å¯†ï¼‰
```

---

## ğŸ“œ Cloud-Init è„šæœ¬åˆ†æ

`SystemScriptShell.java` ä¸­çš„ cloud-init è„šæœ¬åŠŸèƒ½ï¼š

1. **è®¾ç½® root å¯†ç ** - ä½¿ç”¨ç”¨æˆ·é…ç½®çš„å¯†ç 
2. **å¯ç”¨ SSH å¯†ç è®¤è¯** - ä¿®æ”¹ `/etc/ssh/sshd_config`
3. **å¯ç”¨ root ç™»å½•** - å…è®¸ root ç”¨æˆ· SSH ç™»å½•
4. **å¼ºåˆ¶å¯†ç æ›´æ”¹** - é¦–æ¬¡ç™»å½•åå¼ºåˆ¶æ›´æ”¹å¯†ç 

**å®‰å…¨è¯„ä¼°**: è„šæœ¬åŠŸèƒ½é€æ˜ï¼Œæ— æ¶æ„è¡Œä¸ºã€‚ä½†å¯ç”¨ root å¯†ç ç™»å½•å­˜åœ¨ä¸€å®šå®‰å…¨é£é™©ï¼Œå»ºè®®ç”¨æˆ·ä½¿ç”¨åç«‹å³ç¦ç”¨ã€‚

---

## ğŸ“ æ–‡ä»¶æ¸…å•

### æ‰€æœ‰ Java æºæ–‡ä»¶ï¼ˆ22 ä¸ªï¼‰

```
oci-server/src/main/java/com/doubledimple/ociserver/
â”œâ”€â”€ OciServerApplication.java                           # åº”ç”¨å…¥å£
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ CompartmentLifecycleStateDeserializer.java     # JSON ååºåˆ—åŒ–
â”‚   â”œâ”€â”€ CustomObjectMapperFactory.java                 # JSON é…ç½®
â”‚   â”œâ”€â”€ CustomShapeBillingTypeDeserializer.java        # JSON ååºåˆ—åŒ–
â”‚   â”œâ”€â”€ MultiUserAuthenticationDetailsProvider.java   # å¤šç”¨æˆ·è®¤è¯
â”‚   â””â”€â”€ OracleUsersConfig.java                         # ç”¨æˆ·é…ç½®
â”œâ”€â”€ constant/
â”‚   â””â”€â”€ SystemScriptShell.java                         # Cloud-init è„šæœ¬
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ OracleInstanceDetail.java                      # å®ä¾‹è¯¦æƒ… DTO
â”‚   â””â”€â”€ User.java                                      # ç”¨æˆ·é…ç½® DTO
â”œâ”€â”€ enums/
â”‚   â”œâ”€â”€ ArchitectureEnum.java                          # æ¶æ„æšä¸¾(AMD/ARM)
â”‚   â”œâ”€â”€ MessageEnum.java                               # æ¶ˆæ¯ç±»å‹æšä¸¾
â”‚   â””â”€â”€ OperationSystemEnum.java                       # æ“ä½œç³»ç»Ÿæšä¸¾
â”œâ”€â”€ exception/
â”‚   â”œâ”€â”€ ErrorCode.java                                 # é”™è¯¯ç æšä¸¾
â”‚   â”œâ”€â”€ OciException.java                              # è‡ªå®šä¹‰å¼‚å¸¸
â”‚   â””â”€â”€ OciExceptionFactory.java                       # å¼‚å¸¸å·¥å‚
â”œâ”€â”€ message/
â”‚   â”œâ”€â”€ DingDingMessageService.java                    # é’‰é’‰æ¶ˆæ¯ï¼ˆç©ºå®ç°ï¼‰
â”‚   â”œâ”€â”€ MessageService.java                            # æ¶ˆæ¯æ¥å£
â”‚   â”œâ”€â”€ TelegramMessageService.java                    # Telegram æ¶ˆæ¯
â”‚   â””â”€â”€ factory/
â”‚       â””â”€â”€ MessageFactory.java                        # æ¶ˆæ¯å·¥å‚
â””â”€â”€ service/
    â”œâ”€â”€ OracleCloudService.java                        # äº‘æœåŠ¡æ ¸å¿ƒï¼ˆ1042è¡Œï¼‰
    â””â”€â”€ OracleInstanceManager.java                     # å®ä¾‹ç®¡ç†å™¨
```

---

## ğŸ¯ GitHub Actions å·¥ä½œæµ

| æ–‡ä»¶ | åŠŸèƒ½ | å®‰å…¨æ€§ |
|------|------|--------|
| `main.yml` | ç‰ˆæœ¬å‘å¸ƒ Telegram é€šçŸ¥ | âœ… å®‰å…¨ |
| `telegram-notify.yml` | Issue/Star æ´»åŠ¨é€šçŸ¥ | âœ… å®‰å…¨ |

---

## ğŸ“Š æ€»ç»“

### å®‰å…¨ç­‰çº§ï¼šğŸŸ¢ **å®‰å…¨**

| è¯„ä¼°ç»´åº¦ | ç»“è®º |
|----------|------|
| **æºä»£ç å¼€æºç¨‹åº¦** | 100% å¼€æºï¼Œæ— ç¼–è¯‘æ–‡ä»¶æˆ–æ··æ·†ä»£ç  |
| **åé—¨æ£€æµ‹** | æœªå‘ç°ä»»ä½•åé—¨æˆ–æ¶æ„ä»£ç  |
| **å¤–éƒ¨è¿æ¥** | ä»… Telegram APIï¼ˆç”¨æˆ·å¯é€‰é…ç½®ï¼‰ |
| **ä¾èµ–å®‰å…¨** | å…¨éƒ¨æ¥è‡ªå®˜æ–¹ä»“åº“ï¼Œæ— ç§æœ‰ä¾èµ– |
| **è®¸å¯è¯** | Apache License 2.0ï¼ˆå¼€æºå‹å¥½ï¼‰ |

### å»ºè®®äº‹é¡¹

1. **å‡çº§ Log4j** - ä» 1.2.17 å‡çº§åˆ° Log4j 2.x æˆ–æ›¿æ¢ä¸º Logback
2. **å¯†ç åŠ å¯†** - è€ƒè™‘å¯¹é…ç½®æ–‡ä»¶ä¸­çš„ rootPassword è¿›è¡ŒåŠ å¯†å­˜å‚¨
3. **SSH å®‰å…¨** - ä½¿ç”¨å®Œæˆåå»ºè®®ç¦ç”¨ root å¯†ç ç™»å½•ï¼Œæ”¹ç”¨å¯†é’¥è®¤è¯

---

## ğŸ“ å®¡è®¡å£°æ˜

æœ¬æŠ¥å‘ŠåŸºäºä»£ç é™æ€åˆ†æå®Œæˆï¼Œå·²å®¡æŸ¥äº†é¡¹ç›®ä¸­çš„æ‰€æœ‰æºä»£ç æ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œæ„å»ºè„šæœ¬ã€‚å®¡è®¡èŒƒå›´åŒ…æ‹¬ä½†ä¸é™äºï¼š

- Java æºä»£ç ï¼ˆ22 ä¸ªæ–‡ä»¶ï¼‰
- Maven æ„å»ºé…ç½®ï¼ˆ3 ä¸ª pom.xmlï¼‰
- é…ç½®å±æ€§æ–‡ä»¶ï¼ˆ3 ä¸ª .propertiesï¼‰
- GitHub Actions å·¥ä½œæµï¼ˆ2 ä¸ª .ymlï¼‰
- è®¸å¯è¯æ–‡ä»¶

**å®¡è®¡ç»“è®º**: è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ª **å®Œå…¨å¼€æºã€æ— åé—¨** çš„ Oracle Cloud å®ä¾‹ç®¡ç†å·¥å…·ã€‚

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-12-09 20:49 UTC*
